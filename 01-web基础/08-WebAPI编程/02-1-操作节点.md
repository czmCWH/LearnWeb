# èŠ‚ç‚¹æ“ä½œ

> åˆ©ç”¨ DOM æä¾›çš„æ–¹æ³•è·å–å…ƒç´ é€»è¾‘æ€§ä¸å¼ºã€ç¹çã€‚å¯ä»¥**ä½¿ç”¨èŠ‚ç‚¹çš„å±‚çº§å…³ç³»è·å–å…ƒç´ **ï¼šåˆ©ç”¨çˆ¶å­å…„å¼ŸèŠ‚ç‚¹å…³ç³»è·å–å…ƒç´ ï¼›é€»è¾‘æ€§å¼ºï¼Œä½†æ˜¯å…¼å®¹æ€§ç¨å·®ï¼›

* ç½‘é¡µä¸­çš„æ‰€æœ‰å†…å®¹éƒ½æ˜¯èŠ‚ç‚¹ï¼ˆæ ‡ç­¾ã€å±æ€§ã€æ–‡æœ¬ã€æ³¨é‡Šç­‰ï¼‰ï¼Œåœ¨DOM ä¸­ï¼ŒèŠ‚ç‚¹ä½¿ç”¨ node æ¥è¡¨ç¤ºã€‚

* HTML DOM æ ‘ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹å‡å¯é€šè¿‡ JavaScript è¿›è¡Œè®¿é—®ï¼Œæ‰€æœ‰ HTML å…ƒç´ ï¼ˆèŠ‚ç‚¹ï¼‰å‡å¯è¢«ä¿®æ”¹ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºæˆ–åˆ é™¤ã€‚

* ä¸€èˆ¬åœ°ï¼ŒèŠ‚ç‚¹è‡³å°‘æ‹¥æœ‰nodeTypeï¼ˆèŠ‚ç‚¹ç±»å‹ï¼‰ã€nodeNameï¼ˆèŠ‚ç‚¹åç§°ï¼‰å’ŒnodeValueï¼ˆèŠ‚ç‚¹å€¼ï¼‰è¿™ä¸‰ä¸ªåŸºæœ¬å±æ€§ã€‚
â€‹
â€‹å…ƒç´ èŠ‚ç‚¹ nodeType == 1ï¼Œå¼€å‘ä¸­ä¸»è¦æ“ä½œã€‚
â€‹å±æ€§èŠ‚ç‚¹ nodeType == 2
æ–‡æœ¬èŠ‚ç‚¹ nodeType == 3 (æ–‡æœ¬èŠ‚ç‚¹åŒ…å«æ–‡å­—ã€ç©ºæ ¼ã€æ¢è¡Œç­‰)

## ä¸€ã€èŠ‚ç‚¹å±‚çº§

â€‹åˆ©ç”¨ DOM æ ‘å¯ä»¥æŠŠèŠ‚ç‚¹åˆ’åˆ†ä¸ºä¸åŒçš„å±‚çº§å…³ç³»ï¼Œå¸¸è§çš„æ˜¯çˆ¶å­å…„å±‚çº§å…³ç³»ã€‚
â€‹
### 1.1ã€è·å–çˆ¶å­çº§èŠ‚ç‚¹
â€‹
* `â€‹node.parentNode`ï¼Œè¿”å›**æœ€è¿‘çš„ä¸€ä¸ªçˆ¶èŠ‚ç‚¹**ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šçˆ¶èŠ‚ç‚¹ï¼Œåˆ™è¿”å›nullã€‚

```javaScript
â€‹<div class="box">
	<div class="father">
		<div class="son"></div>
	</div>
</div>

<script>
    var son = document.querySelector('.son');
    console.log(son);
    console.log(son.parentNode);
</script>
```
â€‹
* `node.childNodes`ï¼Œæ ‡å‡†å†™æ³•ï¼Œ**è·å–æ‰€æœ‰å­èŠ‚ç‚¹**ï¼ˆåŒ…å« å…ƒç´  + æ–‡æœ¬èŠ‚ç‚¹ï¼‰ã€‚ä¸æ¨èä½¿ç”¨ã€‚

```js
â€‹<ul>
	<li>åˆ†ç±»</li>
	<li>å…¶å®ƒ</li>
	<li>åœˆå­</li>
	<li>æˆ‘çš„</li>
</ul>

<script>
    var ul = document.querySelector('ul');
    var lis = ul.querySelectorAll('li');
        
    console.log(ul.childNodes); // å…±9ä¸ªï¼Œå› ä¸º ul ä¸­liä¹‹é—´æœ‰ 5ä¸ªæ¢è¡ŒèŠ‚ç‚¹ã€‚
</script>
```

* `â€‹node.children`ï¼Œéæ ‡å‡†å†™æ³•ï¼Œæ˜¯ä¸€ä¸ªåªè¯»å±æ€§ï¼Œè¿”å›**æ‰€æœ‰çš„å­å…ƒç´ èŠ‚ç‚¹**ã€‚è™½ç„¶æ˜¯ä¸€ä¸ªéæ ‡å‡†ï¼Œä½†æ˜¯å¾—åˆ°äº†å„ä¸ªæµè§ˆå™¨æ”¯æŒï¼Œå¯ä»¥æ”¾å¿ƒä½¿ç”¨ã€‚

```javaScript
<ul>
	<li>å¹³æ¿</li>
	<li>æ‰‹æœº</li>
	<li>ç”µè„‘</li>
	<li>æ‰‹ç¯</li>
</ul>

<script>
    var ul = document.querySelector('ul');
    console.log(ul.children);
    console.log(ul.childNodes[1].nodeType);
</script>
```

```javaScript
<ol>
	<li>ä»»åŠ¡1</li>
	<li>ä»»åŠ¡2</li>
	<li>ä»»åŠ¡3</li>
	<li>ä»»åŠ¡4</li>
</ol>

var ol = document.querySelector('ol');

// 1ã€è·å–ç¬¬ä¸€ä¸ªæˆ–æœ€åä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œæ‰¾ä¸åˆ°è¿”å›null
console.log(ol.firstChild);
console.log(ol.lastChild);

// 2ã€è·å–ç¬¬ä¸€ä¸ªæˆ–æœ€åä¸€ä¸ªå­å…ƒç´ èŠ‚ç‚¹ï¼ŒIE9ä»¥ä¸Šæ”¯æŒï¼Œæ‰¾ä¸åˆ°è¿”å›null
console.log(ol.firstElementChild);
console.log(ol.lastElementChild);

// ç›´æ¥é€šè¿‡ children è·å–ï¼Œæ— å…¼å®¹æ€§é—®é¢˜
console.log(ol.children[0]);
console.log(ol.children[ol.children.length - 1]);
```

### 1.2ã€å…„å¼ŸèŠ‚ç‚¹

```javaScript
<p>æˆ‘æ˜¯head</p>
<div>æˆ‘æ˜¯div</div>
<span>æˆ‘æ˜¯span</span>

<script>
	var div = document.querySelector('div');
	// 1ã€è·å–å…„å¼ŸèŠ‚ç‚¹ï¼Œå¯èƒ½æ˜¯æ–‡æœ¬èŠ‚ç‚¹ã€å…ƒç´ èŠ‚ç‚¹ç­‰ç­‰ã€‚
	console.log('è·å–ä¸‹ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹=', div.nextSibling);
	console.log('è·å–ä¸Šä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹=', div.previousSibling);

	console.log('è·å–ä¸‹ä¸€ä¸ªå…„å¼Ÿå…ƒç´ èŠ‚ç‚¹=', div.nextElementSibling);
	console.log('è·å–ä¸Šä¸€ä¸ªå…„å¼Ÿå…ƒç´ èŠ‚ç‚¹=', div.previousElementSibling);
</script>
```

ç”±äºè·å–å…„å¼Ÿå…ƒç´ èŠ‚ç‚¹å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ï¼Œç»å¸¸é‡‡ç”¨å¦‚ä¸‹æ–¹å¼å¤„ç†ï¼š

```javaScript
function getNextElementSibling(element) {
  var el = element;
  while (el = el.nextSibling) {
    if (el.nodeType === 1) {
        return el;
    }
  }
  return null;
}  
```

## äºŒã€æ“ä½œèŠ‚ç‚¹

### 2.1ã€åˆ›å»ºå…ƒç´ èŠ‚ç‚¹ï¼Œæ·»åŠ å…ƒç´ èŠ‚ç‚¹ã€‚

```javaScript

<ul></ul>

<script>
	// 1ã€åˆ›å»ºèŠ‚ç‚¹ï¼Œå…ƒç´ èŠ‚ç‚¹
	var li = document.createElement('li');
	li.innerHTML = 'åˆ›å»ºçš„ç¬¬ä¸€ä¸ªli';
	
	// 2ã€åœ¨çˆ¶èŠ‚ç‚¹æœ«å°¾æ·»åŠ å­èŠ‚ç‚¹
	var ul = document.querySelector('ul');
	ul.appendChild(li);

	// 3ã€åœ¨æŸä¸ªå…ƒç´ çš„å‰é¢æ·»åŠ å­èŠ‚ç‚¹
	var li2 = document.createElement('li');
	li2.innerHTML = 'åˆ›å»ºçš„ç¬¬äºŒä¸ªli';
	ul.insertBefore(li2, ul.children[0]);
</script>
```

ä¸¾ä¸ªğŸŒ°ï¼šç•™è¨€æ¿ã€‚

```javaScript
<body>
    <textarea name="" id=""></textarea>
    <button>å‘å¸ƒ</button>
    <ul>

    </ul>
    <script>
        // 1. è·å–å…ƒç´ 
        var btn = document.querySelector('button');
        var text = document.querySelector('textarea');
        var ul = document.querySelector('ul');
        // 2. æ³¨å†Œäº‹ä»¶
        btn.onclick = function() {
            if (text.value == '') {
                alert('æ‚¨æ²¡æœ‰è¾“å…¥å†…å®¹');
                return false;
            } else {
                // console.log(text.value);
                // (1) åˆ›å»ºå…ƒç´ 
                var li = document.createElement('li');
                // å…ˆæœ‰li æ‰èƒ½èµ‹å€¼
                li.innerHTML = text.value;
                // (2) æ·»åŠ å…ƒç´ 
                // ul.appendChild(li);
                ul.insertBefore(li, ul.children[0]);
            }
        }
    </script>
</body>
```

### 2.2ã€åˆ é™¤èŠ‚ç‚¹

`node.removeChild()` æ–¹æ³•ä» nodeèŠ‚ç‚¹ä¸­åˆ é™¤ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œè¿”å›åˆ é™¤çš„èŠ‚ç‚¹ã€‚

```javaScript
 <button>åˆ é™¤</button>
<ul>
    <li>ç†Šå¤§</li>
    <li>ç†ŠäºŒ</li>
    <li>å…‰å¤´å¼º</li>
</ul>
<script>
    // 1.è·å–å…ƒç´ 
    var ul = document.querySelector('ul');
    var btn = document.querySelector('button');
    // 2. ç‚¹å‡»æŒ‰é’®ä¾æ¬¡åˆ é™¤é‡Œé¢çš„å­èŠ‚ç‚¹
    btn.onclick = function() {
        if (ul.children.length == 0) {
            this.disabled = true;
        } else {
            // åˆ é™¤å…ƒç´ 
            ul.removeChild(ul.children[0]);
        }
    }
</script>
```

### 2.3ã€å¤åˆ¶èŠ‚ç‚¹

`node.cloneNode(ã€booleanã€‘)`ï¼Œå¤åˆ¶èŠ‚ç‚¹ï¼Œå¦‚æœæ‹¬å·é‡Œé¢çš„å‚æ•°ä¸º ç©º æˆ–è€…ä¸º falseï¼Œåˆ™æ˜¯æµ…æ‹·è´ï¼Œå³åªå…‹éš†èŠ‚ç‚¹æœ¬èº«ï¼Œä¸å¤åˆ¶èŠ‚ç‚¹çš„å†…å®¹ã€‚

```javaScript
<ul>
	<li>111</li>
	<li>222</li>
	<li>333</li>
</ul>

<script>
	var ul = document.querySelector('ul');
	var newLi = ul.children[0].cloneNode(true);
	ul.appendChild(newLi);
</script>
```

## ä¸‰ã€åˆ›å»ºå…ƒç´ çš„ä¸‰ç§æ–¹å¼

### 3.1ã€document.write()

`document.write()`ï¼šä½¿ç”¨æ¯”è¾ƒå°‘ï¼Œæ˜¯ç›´æ¥å°†å†…å®¹å†™å…¥é¡µé¢çš„å†…å®¹æµï¼Œä½†æ˜¯æ–‡æ¡£æµæ‰§è¡Œå®Œæ¯•ï¼Œåˆ™å®ƒä¼šå¯¼è‡´é¡µé¢å…¨éƒ¨é‡ç»˜ã€‚å¦‚ä¸‹ç¤ºä¾‹ï¼Œç‚¹å‡»æŒ‰é’®ä¼šå¯¼è‡´é‡ç»˜ï¼ŒåŸæ¥çš„å†…å®¹å…¨éƒ¨è¦†ç›–ã€‚

```javaScript
<button>writeæ–¹å¼åˆ›å»º</button>
<div>123</div>

<script>
	
	var btn = document.querySelector('button');
	btn.onclick = function() {
		document.write('<div>writeæ–¹å¼åˆ›å»º</div>');
	}
</script>
```

### 3.2ã€element.innnerHTML

`element.innnerHTML`ï¼šå­—ç¬¦ä¸²æ–¹å¼å†™å…¥htmlæ ‡ç­¾ã€‚

ä¾‹å­1ï¼šå¦‚æœä»¥å­—ç¬¦ä¸²æ‹¼æ¥æ–¹å¼ï¼Œæ•ˆç‡æœ€ä½ï¼›é‡‡ç”¨æ•°ç»„æ–¹å¼æ•ˆç‡æœ€é«˜ï¼Œç»“æ„ç¨å¾®å¤æ‚

```javaScript
var dtB1 = +new Date();
var box = document.querySelector('.inner');
for (var i = 0; i < 1000; i++) {
	box.innerHTML += '<a href="https://www.baidu.com" >ç™¾åº¦</a>';
}
var dtE1 = +new Date();
console.log(dtE1 - dtB1);	// 433
```

ä¾‹å­2ï¼šé‡‡ç”¨æ•°ç»„çš„æ–¹å¼å†™å…¥æ ‡ç­¾ï¼Œæ•ˆç‡æœ€é«˜ï¼Œä½†æ˜¯é€»è¾‘ä¸æ¸…æ™°ã€‚
```javaScript
var dtB1 = +new Date();
var box = document.querySelector('.inner');
var arr = [];
for (var i = 0; i < 1000; i++) {
	arr.push('<a href="https://www.baidu.com" >ç™¾åº¦</a>');
}
box.innerHTML = arr.join('');
var dtE1 = +new Date();
console.log(dtE1 - dtB1);	
```

### 3.3ã€document.createElement()

`document.createElement()` æ•ˆç‡æ¯” `innerHTML` çš„æ•°ç»„æ–¹å¼ç¨å¾®ä½ï¼Œä½†æ˜¯ç»“æ„æ›´æ¸…æ™°ã€‚

```javaScript
var dtB2 = +new Date();
var box2 = document.querySelector('.create');
for (var i = 0; i < 1000; i++) {
	var a = document.createElement('a');
	a.innerHTML = 'ç™¾åº¦';
	a.href = 'https://www.baidu.com';
	box2.appendChild(a);
}
var dtE2 = +new Date();
console.log(dtE2 - dtB2);
```

## å››ã€DOM é‡ç‚¹æ€»ç»“

æ–‡æœ¬å¯¹è±¡æ¨¡å‹ï¼ˆDocument Object Modelï¼Œç®€ç§°DOMï¼‰ï¼Œæ˜¯ W3C ç»„ç»‡æ¨èçš„å¤„ç†å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼ˆHTMLæˆ–è€…XMLï¼‰çš„æ ‡å‡†ç¼–ç¨‹æ¥å£ã€‚

W3C å·²ç»å®šä¹‰äº†ä¸€ç³»åˆ—çš„DOMæ¥å£ï¼Œé€šè¿‡è¿™äº›æ¥å£å¯ä»¥æ”¹å˜ç½‘é¡µçš„å†…å®¹ã€ç»“æ„å’Œæ ·å¼ã€‚

1ã€å¯¹äºJavaScriptï¼Œä¸ºäº†èƒ½å¤Ÿä½¿JavaScriptæ“ä½œHTMLï¼ŒJavaScriptå°±æœ‰äº†ä¸€å¥—è‡ªå·±çš„domç¼–ç¨‹æ¥å£ã€‚

2ã€å¯¹äºHTMLï¼Œdomä½¿å¾—htmlå½¢æˆäº†ä¸€æ£µDOMæ ‘ï¼ŒåŒ…æ‹¬æ–‡æ¡£ã€å…ƒç´ ã€èŠ‚ç‚¹ã€‚

å…³äºDOMæ“ä½œï¼Œä¸»è¦é’ˆå¯¹å…ƒç´ çš„æ“ä½œï¼Œä¸»è¦æœ‰ï¼šåˆ›å»ºã€å¢ã€åˆ ã€æ”¹ã€æŸ¥ã€å±æ€§æ“ä½œã€äº‹ä»¶æ“ä½œã€‚